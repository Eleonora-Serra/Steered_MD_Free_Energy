### to compute free energy for several frames ###

free_energy_frames = []
i_frame = 40
f_frame = 120

for frame in range(i_frame, f_frame):
    Jarzynski_Free_Energy_Binding = binding_free_energy(file_FreeEnergy=file_Jarzynski_FreeEnergy,
                                                    discrim_frame=frame,
                                                    invert=invert)    
    free_energy_frames.append(Jarzynski_Free_Energy_Binding)

frames = list(range(i_frame, f_frame))
discrim_x = [(frame-initial_s)/(final_s-initial_s) for frame in frames]
file_Jarzynski_FreeEnergy_vs_frame = output_files_path +'/Jarzynski_FreeEnergy_%s_%s_vs_frame.csv'%(simulation,sim_time)
Jarzynski_df = pd.DataFrame({'S(x)*':discrim_x, 'x*': frames, 'Jarzynski_FreeEnergy':free_energy_frames})
Jarzynski_df.to_csv(file_Jarzynski_FreeEnergy_vs_frame, header = True, sep=',', index = None)print(f'x:{discrim_x}, free_energy:{free_energy_frames}')plt.plot(discrim_x,free_energy_frames, color='green', linewidth = 2, marker='o', markerfacecolor='blue', markersize=2)plt.xlabel('discriminating frame')
plt.ylabel('Free Energy [kcal/mol]')
plt.savefig(f'{output_files_path}/Jarzynski_FreeEnergy_{simulation}_{sim_time}_vs_frame.png')

